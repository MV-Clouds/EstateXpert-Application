<!--
  description       : Display Property component to display all the properties
  author            : Harsh Vora
  last modified on  : 06-19-2024
  last modified by  : Rachit Shah
-->
<template>

    <template if:true={isLoading}>
        <c-spinner-component></c-spinner-component>
    </template>

    <div class="main-card">
			<div>
				<div class="filter-search-container">
					<div class="filter-section">
						<div class="search-bar">
							<lightning-input variant="label-hidden" type="search" placeholder="Enter property name"
								value={searchTerm} onchange={handleSearch}></lightning-input>
						</div>
					</div>
					<div class="view-buttons">
                        <button class={gridButtonClass} onclick={setGridView}>Grid</button>
                        <button class={listButtonClass} onclick={setListView}>List</button>
                        <button class={mapButtonClass} onclick={setMapView}>Map View</button>
                    </div>
				</div>
			</div>
			
			<!-- <div class="filter-container">
				<div class="dotted-border"></div>

				<div class="filter-input">
					<lightning-input label="City" value={filterData.city} onchange={handleInputChange} data-field="city" maxlength="15"></lightning-input>
					<lightning-input label="Bedrooms" value={filterData.bedrooms} type="number" onchange={handleInputChange} data-field="bedrooms" maxlength="5"></lightning-input>
					<lightning-input label="Bathrooms" value={filterData.bathrooms} type="number" onchange={handleInputChange} data-field="bathrooms" max-length="5"></lightning-input>
					<lightning-input label="Zipcode" value={filterData.zipcode} onchange={handleInputChange} data-field="zipcode" max-length="6"></lightning-input>
					<lightning-input label="Min Price" value={filterData.minPrice} type="number" onchange={handleInputChange} data-field="minPrice" max-length="15"></lightning-input>
					<lightning-input label="Max Price" value={filterData.maxPrice} type="number" onchange={handleInputChange} data-field="maxPrice" max-length="15"></lightning-input>
					<div class="listing-buttons">
                        <button class={rentButtonClass} onclick={handleRentClick}>Rent</button>
                        <button class={saleButtonClass} onclick={handleSaleClick}>Sale</button>
                    </div>
				</div>
				<div class="filter-input">
					<div class="filter-btns">
						<button onclick={applyFilters} disabled={isFilterButtonDisabled} class="filter-btn">Apply Filters</button>
						<lightning-button label="Clear Filters" onclick={clearFilter} variant="neutral"></lightning-button>
					</div>
				</div>
			</div> -->

            <div class="slds-col slds-box slds-theme_default">
                <template if:true={isPropertyAvailable}>
                    <template if:true={isListView}>
                        <table class="custom-data-table">
                            <thead>
                                <tr>
                                    <th class="header-cell">Image</th>
                                    <th class="header-cell">Name</th>
                                    <th class="header-cell">Listing Type</th>
                                    <th class="header-cell">City</th>
                                    <th class="header-cell">Bedrooms</th>
                                    <th class="header-cell">Bathrooms</th>
                                    <th class="header-cell">Price</th>
                                    <th class="header-cell">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={pagedProperties} for:item="property">
                                    <tr key={property.id}>
                                        <td class="image-data">
                                            <img src={property.media_url} alt="Property image" />
                                        </td>
                                        <td>{property.Name}</td>
                                        <td>{property.Listing_Type__c}</td>
                                        <td>{property.City__c}</td>
                                        <td>{property.Bedrooms__c}</td>
                                        <td>{property.Bathrooms__c}</td>
                                        <td>
                                            <template if:true={property.Listing_Price__c}>
                                                {property.CurrencyIsoCode} {property.Listing_Price__c}
                                            </template>
                                            <template if:false={property.Listing_Price__c}>
                                                TBD
                                            </template>
                                        </td>
                                        <td>
                                            <button class="view-more-button" data-id={property.Id} onclick={navigateToRecord}>View More</button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </template>

                    <template if:true={isGridView}>
                        <div class="slds-grid slds-wrap">
                            <template for:each={pagedProperties} for:item="property">
                                <div class="card slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-3"
                                    key={property.id}>
                                    <div class="property-item">
                                        <img class="property-image card-img-top" src={property.media_url} alt="Property image"></img>
                                        <div class="property_type">
                                            <p>For {property.Listing_Type__c}</p>
                                        </div>
                                        <div class="card-body details">
                                            <h5 class="card-title"><b>{property.Name}</b></h5>
                                            <div class="card-text">
                                                <img src={location_icon} height="18px" width="18px"/>
                                                <p class="slds-m-left_xx-small">{property.City__c}, {property.State__c}, {property.PostalCode__c}</p>
                                            </div>
                                            <div class="room_details">
                                                <lightning-layout-item class="bedroom">
                                                    <img src={bedroom_icon} height="24px" width="20px" />
                                                    <h1 class="slds-m-left_xx-small">{property.Bedrooms__c} Bedrooms</h1>
                                                </lightning-layout-item>
                                                <lightning-layout-item class="bathroom" alignment-bump="left">
                                                    <img src={bathroom_icon} class="bathroom_icon"/>
                                                    <h1 class="slds-m-left_xx-small">{property.Bathrooms__c} Bathrooms</h1>
                                                </lightning-layout-item>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <lightning-layout-item class="item-1">
                                                <p class="card-link"><b>
                                                    <template if:true={property.Listing_Price__c}>
                                                        {property.CurrencyIsoCode} {property.Listing_Price__c}
                                                    </template>
                                                    <template if:false={property.Listing_Price__c}>
                                                        TBD
                                                    </template>
                                                </b></p>
                                            </lightning-layout-item>
                                            <lightning-layout-item class="item-2" alignment-bump="left">
                                                <button data-id={property.Id} onclick={navigateToRecord}>View More</button>
                                            </lightning-layout-item>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </template>

                    <template if:true={isMapView}>
                        <div class="main">
                            <lightning-map class="mapmarker slds-size_6-of-6" map-markers={mapMarkers} list-view="visible">
                            </lightning-map>
                        </div>
                    </template>
                </template>

                <template if:false={isPropertyAvailable}>
                    <div class="no_prop">
                        <p>No properties found. Please change your search filters and try again.</p>
                    </div>
                </template>
            </div>

            <template if:true={isPropertyAvailable}>
                <div class="pagination-container slds-m-top_medium">
                    <button class="edit-btn" onclick={goToFirst} disabled={isFirstPage}> First</button>
                    <button class="edit-btn" onclick={goToPrevious} disabled={isFirstPage}> Previous</button>
                    <button class="edit-btn" onclick={goToNext} disabled={isLastPage}> Next</button>
                    <button class="edit-btn" onclick={goToLast} disabled={isLastPage}> Last</button>
                </div>
            </template>
    </div>
</template>